\htmlhr
\chapterAndLabel{Initialized Fields Checker}{initialized-fields-checker}

The Initialized Fields Checker warns if a constructor does not initialize a
field.
If you supply the \<-AcheckInitializedFields=...> command-line argument,
then warnings are issued only if the default value assigned by Java (0,
true, or null) is not consistent with the field's annotation, for the given
type systems.

An example invocation is

\begin{Verbatim}
javac -processor ValueChecker,InitializedFieldsChecker \
  -AcheckInitializedFields=org.checkerframework.common.value.ValueChecker \
  MyFile.java
\end{Verbatim}

The \<-AcheckInitializedFields> is a comma-separated list of
fully-qualified names of checkers.  They are used to determine whether a
field's type is consistent with the Java default value (0, true, or null).


\sectionAndLabel{Example}{initialized-fields-example}

As an example, consider the following code:

\begin{Verbatim}
import org.checkerframework.checker.index.qual.Positive;

public class ManualConstructor {

  @Positive int x;
  @Positive int y;
  int z;

  // Warning: field y is not initialized
  ManualConstructor() {
    x = 1;
  }
}
\end{Verbatim}

When run with the
\<-AcheckInitializedFields=org.checkerframework.common.value.IndexChecker>
command-line option, the Initialized Fields Checker warns that field \<y>
is not set.  It does not warn about field \<z>, because its default value
(0) is consistent with its annotations.

To warn about the lack of initialization of both field \<y> and field \<z>,
pass no \<-AcheckInitializedFields> command-line option.


\sectionAndLabel{Annotations}{initialized-fields-annotations}

The Initialized Fields type system uses the following type annotations:
\begin{description}
\item[\refqualclass{checker/initializedfields/qual}{InitializedFields}]
  indicates which fields have definitely been initialized so far.
\item[\refqualclass{checker/initializedfields/qual}{InitializedFieldsBottom}]
  is the type of \<null>.  Programmers rarely write this type.
\item[\refqualclass{checker/initializedfields/qual}{PolyInitializedFields}]
  is a qualifier that is polymorphic over field initialization (see
  Section~\ref{method-qualifier-polymorphism}).
\end{description}

% TODO: draw a diagram of the type hierarchy.

There is also a method declaration annotation:

\begin{description}
\item[\refqualclass{checker/initializedfields/qual}{EnsuresInitializedFields}]
  indicates which fields the method sets.  Use this for helper methods that
  are called from a constructor.
\end{description}


\sectionAndLabel{Comparison to the Initialization Checker}{initialized-fields-vs-initialization}

The Initialized Fields Checker is a lightweight version of the  Initialization Checker
(Section~\ref{initialization-checker}).  Here is a comparison between them.

\noindent
\begin{small}
\begin{tabular}{| l | l | l |}
 \hline
 & Initialization Checker & Initialized Fields Checker
 \\ \hline
 superclasses
 & tracks initialization of supertype fields
 & checks one class at a time
 \\
 partial initialization
 & changes the types of fields that are not initialized
 & unsound treatment of partially-initialized objects
 \\
 type systems
 & works only with the Nullness Checker (*)
 & works for any type system
 \\
 disabling
 & always runs with the Nullness Checker
 & can be enabled/disabled per run
 \\
 \hline
\end{tabular}

\noindent
* The Initialization Checker could be made to work with any type system, but
doing so would require changing the implementation of both the type system and
the Initialization Checker.
\end{small}


% LocalWords:  AcheckInitializedFields InitializedFields
% LocalWords:  InitializedFieldsBottom PolyInitializedFields
% LocalWords:  EnsuresInitializedFields
